
<p-toast></p-toast>
<!-- <app-ir-arriba></app-ir-arriba> -->
<div class="paginaCompleta">


        <p-toolbar class ="toolClass">
    <div class="p-toolbar-group-start">
        <p-button severity="danger"  label="Nuevo" icon="pi pi-plus" (onClick)="nuevoMueble()"></p-button>
    </div>
    <div class="p-toolbar-group-center">
         <span class="p-input-icon-left ml-auto">
            <i class="pi pi-search"></i>
            <input pInputText type="text" [(ngModel)]="nombreFiltro" (input)="filtrarPorNombre()"  placeholder="Filtrar por nombre" /> 
         </span> 
    </div>
    <div class="p-toolbar-group-end">
        <div >
            <p-selectButton (onChange)="resetTabla()"  [allowEmpty]="false" [options]="tableStateOption" [(ngModel)]="tableSelected" optionLabel="label" optionValue="value" ></p-selectButton>
        </div>

     
    </div>
</p-toolbar>
   
        <p-table 
            #miTabla
            class="table"
            [value]=" tableSelected === 'dispositivos' ? mueblesDispositivosFiltrados : mueblesCartelesFiltrados"
            [paginator]="true"
            [rows]="10"
            [scrollable]="true"
            [scrollHeight]="'calc(100vh - 300px )'"

            paginatorStyleClass="background-color: rgba(232, 232, 232, 0.9);"
            [showCurrentPageReport]="true"
            [tableStyle]="{ 'min-width': '50rem' }"
            currentPageReportTemplate="Enseñando {first} de {last} de en total {totalRecords} muebles"
            [rowsPerPageOptions]="[10, 25, 50]"
            [globalFilterFields]="['nombre_mueble', ]"
    >
        <ng-template pTemplate="caption" >
             <p class="p-m-0 text-2xl"> Muebles</p>

            <p-progressSpinner *ngIf="(mueblesDispostivos.length == 0 || mueblesCarteles.length == 0)? true: false"   fill="var(--surface-ground)" [style]="{'width': '5%', 'height': '5%'}" animationDuration=".6s"  class="fadein animation-duration-1000 "></p-progressSpinner>
            
        </ng-template>
        <ng-template pTemplate="header">
            <tr>
             
            <th>Expositor</th>
            <th pSortableColumn="nombre_mueble">Nombre <p-sortIcon field="nombre_mueble"></p-sortIcon></th>
            <th pSortableColumn="numero_dispositivos" *ngIf="tableSelected === 'dispositivos'">Número de dispositivos <p-sortIcon field="numero_dispositivos"></p-sortIcon></th> 
            <th>Opciones</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-mueble>
            
            <tr>
              
                <td [ngClass]=" mueble.expositores.length > 1 ?  'expositores-container':''">
                    <div *ngFor="let expositor of mueble.expositores" class="expositor-item">
                        <p-image class ="imagenSimple" [src]="url_imagenes_referencias + expositor.imagenes.url"  height="100vh"  [alt]="expositor.imagenes.url"  [preview]="true"></p-image>
                    </div>
                    <div *ngIf="mueble.expositores.length < 1">Sin Expositor</div>
                </td>
                <td>{{ mueble.nombre_mueble }}</td>
                <td *ngIf="tableSelected === 'dispositivos'">{{ mueble.numero_dispositivos }}</td>
                <td class="opciones">         
                    <p-button severity="danger" class="mr-2" [raised]="true" [text]="true" [rounded]="true" label="Editar" icon="pi pi-pencil"  (click)="editMueble(mueble)"></p-button>
                    <p-button  [raised]="true"  [text]="true" [rounded]="true" severity="danger" label="Historial de expositores" icon="pi pi-history" [disabled]="mueble.expositores.length < 1" (click) ="showHistorial(mueble)"></p-button>
                    
                </td>
            </tr>
        </ng-template>

        <ng-template pTemplate="emptymessage">
            <tr>
                <td colspan="3">No hay muebles</td>
            </tr>
        </ng-template>
        
    </p-table>




</div>
